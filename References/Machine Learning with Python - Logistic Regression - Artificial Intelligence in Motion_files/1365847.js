document.write('<link rel="stylesheet" href="https://gist-assets.github.com/assets/embed-8bf0013c72fb64f0bb1bc1872b43e39e.css">')
document.write('<div id=\"gist1365847\" class=\"gist\">\n        <div class=\"gist-file\">\n          <div class=\"gist-data gist-syntax\">\n            \n\n\n\n    <div class=\"file-data\">\n      <table cellpadding=\"0\" cellspacing=\"0\" class=\"lines highlight\">\n        <tr>\n          <td class=\"line-numbers\">\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L1\" rel=\"file-logistic_reg-py-L1\">1<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L2\" rel=\"file-logistic_reg-py-L2\">2<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L3\" rel=\"file-logistic_reg-py-L3\">3<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L4\" rel=\"file-logistic_reg-py-L4\">4<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L5\" rel=\"file-logistic_reg-py-L5\">5<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L6\" rel=\"file-logistic_reg-py-L6\">6<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L7\" rel=\"file-logistic_reg-py-L7\">7<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L8\" rel=\"file-logistic_reg-py-L8\">8<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L9\" rel=\"file-logistic_reg-py-L9\">9<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L10\" rel=\"file-logistic_reg-py-L10\">10<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L11\" rel=\"file-logistic_reg-py-L11\">11<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L12\" rel=\"file-logistic_reg-py-L12\">12<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L13\" rel=\"file-logistic_reg-py-L13\">13<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L14\" rel=\"file-logistic_reg-py-L14\">14<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L15\" rel=\"file-logistic_reg-py-L15\">15<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L16\" rel=\"file-logistic_reg-py-L16\">16<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L17\" rel=\"file-logistic_reg-py-L17\">17<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L18\" rel=\"file-logistic_reg-py-L18\">18<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L19\" rel=\"file-logistic_reg-py-L19\">19<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L20\" rel=\"file-logistic_reg-py-L20\">20<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L21\" rel=\"file-logistic_reg-py-L21\">21<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L22\" rel=\"file-logistic_reg-py-L22\">22<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L23\" rel=\"file-logistic_reg-py-L23\">23<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L24\" rel=\"file-logistic_reg-py-L24\">24<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L25\" rel=\"file-logistic_reg-py-L25\">25<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L26\" rel=\"file-logistic_reg-py-L26\">26<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L27\" rel=\"file-logistic_reg-py-L27\">27<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L28\" rel=\"file-logistic_reg-py-L28\">28<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L29\" rel=\"file-logistic_reg-py-L29\">29<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L30\" rel=\"file-logistic_reg-py-L30\">30<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L31\" rel=\"file-logistic_reg-py-L31\">31<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L32\" rel=\"file-logistic_reg-py-L32\">32<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L33\" rel=\"file-logistic_reg-py-L33\">33<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L34\" rel=\"file-logistic_reg-py-L34\">34<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L35\" rel=\"file-logistic_reg-py-L35\">35<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L36\" rel=\"file-logistic_reg-py-L36\">36<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L37\" rel=\"file-logistic_reg-py-L37\">37<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L38\" rel=\"file-logistic_reg-py-L38\">38<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L39\" rel=\"file-logistic_reg-py-L39\">39<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L40\" rel=\"file-logistic_reg-py-L40\">40<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L41\" rel=\"file-logistic_reg-py-L41\">41<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L42\" rel=\"file-logistic_reg-py-L42\">42<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L43\" rel=\"file-logistic_reg-py-L43\">43<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L44\" rel=\"file-logistic_reg-py-L44\">44<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L45\" rel=\"file-logistic_reg-py-L45\">45<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L46\" rel=\"file-logistic_reg-py-L46\">46<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L47\" rel=\"file-logistic_reg-py-L47\">47<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L48\" rel=\"file-logistic_reg-py-L48\">48<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L49\" rel=\"file-logistic_reg-py-L49\">49<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L50\" rel=\"file-logistic_reg-py-L50\">50<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L51\" rel=\"file-logistic_reg-py-L51\">51<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L52\" rel=\"file-logistic_reg-py-L52\">52<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L53\" rel=\"file-logistic_reg-py-L53\">53<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L54\" rel=\"file-logistic_reg-py-L54\">54<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L55\" rel=\"file-logistic_reg-py-L55\">55<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L56\" rel=\"file-logistic_reg-py-L56\">56<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L57\" rel=\"file-logistic_reg-py-L57\">57<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L58\" rel=\"file-logistic_reg-py-L58\">58<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L59\" rel=\"file-logistic_reg-py-L59\">59<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L60\" rel=\"file-logistic_reg-py-L60\">60<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L61\" rel=\"file-logistic_reg-py-L61\">61<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L62\" rel=\"file-logistic_reg-py-L62\">62<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L63\" rel=\"file-logistic_reg-py-L63\">63<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L64\" rel=\"file-logistic_reg-py-L64\">64<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L65\" rel=\"file-logistic_reg-py-L65\">65<\/span>\n            <span class=\"line-number\" id=\"file-logistic_reg-py-L66\" rel=\"file-logistic_reg-py-L66\">66<\/span>\n          <\/td>\n          <td class=\"line-data\">\n            <pre class=\"line-pre\"><div class=\"line\" id=\"file-logistic_reg-py-LC1\"><span class=\"pl-k\">from<\/span> numpy <span class=\"pl-k\">import<\/span> loadtxt, where, zeros, e, array, log, ones, append, linspace\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC2\"><span class=\"pl-k\">from<\/span> pylab <span class=\"pl-k\">import<\/span> scatter, show, legend, xlabel, ylabel, contour, title\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC3\"><span class=\"pl-k\">from<\/span> scipy.optimize <span class=\"pl-k\">import<\/span> fmin_bfgs\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC4\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC5\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC6\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">sigmoid<\/span>(<span class=\"pl-vpf\">X<\/span>):\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC7\">    <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;&#39;&#39;<\/span>Compute the sigmoid function <span class=\"pl-pds\">&#39;&#39;&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC8\">    <span class=\"pl-c\">#d = zeros(shape=(X.shape))<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC9\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC10\">    den <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">+<\/span> e <span class=\"pl-k\">**<\/span> (<span class=\"pl-k\">-<\/span><span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">*<\/span> X)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC11\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC12\">    d <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> den\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC13\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC14\">    <span class=\"pl-k\">return<\/span> d\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC15\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC16\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC17\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">cost_function_reg<\/span>(<span class=\"pl-vpf\">theta<\/span>, <span class=\"pl-vpf\">X<\/span>, <span class=\"pl-vpf\">y<\/span>, <span class=\"pl-vpf\">l<\/span>):\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC18\">    <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;&#39;&#39;<\/span>Compute the cost and partial derivatives as grads<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC19\"><span class=\"pl-s1\">    <span class=\"pl-pds\">&#39;&#39;&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC20\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC21\">    h <span class=\"pl-k\">=<\/span> sigmoid(X.dot(theta))\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC22\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC23\">    thetaR <span class=\"pl-k\">=<\/span> theta[<span class=\"pl-c1\">1<\/span>:, <span class=\"pl-c1\">0<\/span>]\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC24\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC25\">    J <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> m) <span class=\"pl-k\">*<\/span> ((<span class=\"pl-k\">-<\/span>y.T.dot(log(h))) <span class=\"pl-k\">-<\/span> ((<span class=\"pl-c1\">1<\/span> <span class=\"pl-k\">-<\/span> y.T).dot(log(<span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">-<\/span> h)))) \\\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC26\">            <span class=\"pl-k\">+<\/span> (l <span class=\"pl-k\">/<\/span> (<span class=\"pl-c1\">2.0<\/span> <span class=\"pl-k\">*<\/span> m)) <span class=\"pl-k\">*<\/span> (thetaR.T.dot(thetaR))\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC27\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC28\">    delta <span class=\"pl-k\">=<\/span> h <span class=\"pl-k\">-<\/span> y\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC29\">    sumdelta <span class=\"pl-k\">=<\/span> delta.T.dot(X[:, <span class=\"pl-c1\">1<\/span>])\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC30\">    grad1 <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> m) <span class=\"pl-k\">*<\/span> sumdelta\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC31\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC32\">    XR <span class=\"pl-k\">=<\/span> X[:, <span class=\"pl-c1\">1<\/span>:X.shape[<span class=\"pl-c1\">1<\/span>]]\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC33\">    sumdelta <span class=\"pl-k\">=<\/span> delta.T.dot(XR)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC34\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC35\">    grad <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> m) <span class=\"pl-k\">*<\/span> (sumdelta <span class=\"pl-k\">+<\/span> l <span class=\"pl-k\">*<\/span> thetaR)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC36\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC37\">    out <span class=\"pl-k\">=<\/span> zeros(<span class=\"pl-vpf\">shape<\/span><span class=\"pl-k\">=<\/span>(grad.shape[<span class=\"pl-c1\">0<\/span>], grad.shape[<span class=\"pl-c1\">1<\/span>] <span class=\"pl-k\">+<\/span> <span class=\"pl-c1\">1<\/span>))\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC38\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC39\">    out[:, <span class=\"pl-c1\">0<\/span>] <span class=\"pl-k\">=<\/span> grad1\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC40\">    out[:, <span class=\"pl-c1\">1<\/span>:] <span class=\"pl-k\">=<\/span> grad\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC41\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC42\">    <span class=\"pl-k\">return<\/span> J.flatten(), out.T.flatten()\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC43\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC44\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC45\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC46\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC47\">m, n <span class=\"pl-k\">=<\/span> X.shape\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC48\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC49\">y.shape <span class=\"pl-k\">=<\/span> (m, <span class=\"pl-c1\">1<\/span>)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC50\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC51\">it <span class=\"pl-k\">=<\/span> map_feature(X[:, <span class=\"pl-c1\">0<\/span>], X[:, <span class=\"pl-c1\">1<\/span>])\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC52\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC53\"><span class=\"pl-c\">#Initialize theta parameters<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC54\">initial_theta <span class=\"pl-k\">=<\/span> zeros(<span class=\"pl-vpf\">shape<\/span><span class=\"pl-k\">=<\/span>(it.shape[<span class=\"pl-c1\">1<\/span>], <span class=\"pl-c1\">1<\/span>))\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC55\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC56\"><span class=\"pl-c\">#Set regularization parameter lambda to 1<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC57\">l <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">1<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC58\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC59\"><span class=\"pl-c\"># Compute and display initial cost and gradient for regularized logistic<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC60\"><span class=\"pl-c\"># regression<\/span>\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC61\">cost, grad <span class=\"pl-k\">=<\/span> cost_function_reg(initial_theta, it, y, l)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC62\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC63\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">decorated_cost<\/span>(<span class=\"pl-vpf\">theta<\/span>):\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC64\">    <span class=\"pl-k\">return<\/span> cost_function_reg(theta, it, y, l)\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC65\">&nbsp;\n<\/div><div class=\"line\" id=\"file-logistic_reg-py-LC66\"><span class=\"pl-k\">print<\/span> fmin_bfgs(decorated_cost, initial_theta, <span class=\"pl-vpf\">maxfun<\/span><span class=\"pl-k\">=<\/span><span class=\"pl-c1\">400<\/span>)\n<\/div><\/pre>\n          <\/td>\n        <\/tr>\n      <\/table>\n    <\/div>\n\n          <\/div>\n          <div class=\"gist-meta\">\n            <a href=\"https://gist.github.com/marcelcaraciolo/1365847/raw/logistic_reg.py\" style=\"float:right\">view raw<\/a>\n            <a href=\"https://gist.github.com/marcelcaraciolo/1365847#file-logistic_reg-py\">logistic_reg.py<\/a>\n            hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n          <\/div>\n        <\/div>\n<\/div>\n')
