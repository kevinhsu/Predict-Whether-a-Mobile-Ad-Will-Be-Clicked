document.write('<link rel="stylesheet" href="https://gist-assets.github.com/assets/embed-8bf0013c72fb64f0bb1bc1872b43e39e.css">')
document.write('<div id=\"gist1365841\" class=\"gist\">\n        <div class=\"gist-file\">\n          <div class=\"gist-data gist-syntax\">\n            \n\n\n\n    <div class=\"file-data\">\n      <table cellpadding=\"0\" cellspacing=\"0\" class=\"lines highlight\">\n        <tr>\n          <td class=\"line-numbers\">\n            <span class=\"line-number\" id=\"file-log_regression-py-L1\" rel=\"file-log_regression-py-L1\">1<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L2\" rel=\"file-log_regression-py-L2\">2<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L3\" rel=\"file-log_regression-py-L3\">3<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L4\" rel=\"file-log_regression-py-L4\">4<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L5\" rel=\"file-log_regression-py-L5\">5<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L6\" rel=\"file-log_regression-py-L6\">6<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L7\" rel=\"file-log_regression-py-L7\">7<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L8\" rel=\"file-log_regression-py-L8\">8<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L9\" rel=\"file-log_regression-py-L9\">9<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L10\" rel=\"file-log_regression-py-L10\">10<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L11\" rel=\"file-log_regression-py-L11\">11<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L12\" rel=\"file-log_regression-py-L12\">12<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L13\" rel=\"file-log_regression-py-L13\">13<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L14\" rel=\"file-log_regression-py-L14\">14<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L15\" rel=\"file-log_regression-py-L15\">15<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L16\" rel=\"file-log_regression-py-L16\">16<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L17\" rel=\"file-log_regression-py-L17\">17<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L18\" rel=\"file-log_regression-py-L18\">18<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L19\" rel=\"file-log_regression-py-L19\">19<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L20\" rel=\"file-log_regression-py-L20\">20<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L21\" rel=\"file-log_regression-py-L21\">21<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L22\" rel=\"file-log_regression-py-L22\">22<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L23\" rel=\"file-log_regression-py-L23\">23<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L24\" rel=\"file-log_regression-py-L24\">24<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L25\" rel=\"file-log_regression-py-L25\">25<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L26\" rel=\"file-log_regression-py-L26\">26<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L27\" rel=\"file-log_regression-py-L27\">27<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L28\" rel=\"file-log_regression-py-L28\">28<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L29\" rel=\"file-log_regression-py-L29\">29<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L30\" rel=\"file-log_regression-py-L30\">30<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L31\" rel=\"file-log_regression-py-L31\">31<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L32\" rel=\"file-log_regression-py-L32\">32<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L33\" rel=\"file-log_regression-py-L33\">33<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L34\" rel=\"file-log_regression-py-L34\">34<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L35\" rel=\"file-log_regression-py-L35\">35<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L36\" rel=\"file-log_regression-py-L36\">36<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L37\" rel=\"file-log_regression-py-L37\">37<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L38\" rel=\"file-log_regression-py-L38\">38<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L39\" rel=\"file-log_regression-py-L39\">39<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L40\" rel=\"file-log_regression-py-L40\">40<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L41\" rel=\"file-log_regression-py-L41\">41<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L42\" rel=\"file-log_regression-py-L42\">42<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L43\" rel=\"file-log_regression-py-L43\">43<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L44\" rel=\"file-log_regression-py-L44\">44<\/span>\n            <span class=\"line-number\" id=\"file-log_regression-py-L45\" rel=\"file-log_regression-py-L45\">45<\/span>\n          <\/td>\n          <td class=\"line-data\">\n            <pre class=\"line-pre\"><div class=\"line\" id=\"file-log_regression-py-LC1\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">sigmoid<\/span>(<span class=\"pl-vpf\">X<\/span>):\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC2\">    <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;&#39;&#39;<\/span>Compute the sigmoid function <span class=\"pl-pds\">&#39;&#39;&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC3\">    <span class=\"pl-c\">#d = zeros(shape=(X.shape))<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC4\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC5\">    den <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">+<\/span> e <span class=\"pl-k\">**<\/span> (<span class=\"pl-k\">-<\/span><span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">*<\/span> X)\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC6\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC7\">    d <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> den\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC8\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC9\">    <span class=\"pl-k\">return<\/span> d\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC10\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC11\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC12\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">compute_cost<\/span>(<span class=\"pl-vpf\">theta<\/span>,<span class=\"pl-vpf\">X<\/span>,<span class=\"pl-vpf\">y<\/span>): <span class=\"pl-c\">#computes cost given predicted and actual values<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC13\">    m <span class=\"pl-k\">=<\/span> X.shape[<span class=\"pl-c1\">0<\/span>] <span class=\"pl-c\">#number of training examples<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC14\">    theta <span class=\"pl-k\">=<\/span> reshape(theta,(<span class=\"pl-s3\">len<\/span>(theta),<span class=\"pl-c1\">1<\/span>))\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC15\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC16\">    <span class=\"pl-c\">#y = reshape(y,(len(y),1))<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC17\">    \n<\/div><div class=\"line\" id=\"file-log_regression-py-LC18\">    J <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1.<\/span><span class=\"pl-k\">/<\/span>m) <span class=\"pl-k\">*<\/span> (<span class=\"pl-k\">-<\/span>transpose(y).dot(log(sigmoid(X.dot(theta)))) <span class=\"pl-k\">-<\/span> transpose(<span class=\"pl-c1\">1<\/span><span class=\"pl-k\">-<\/span>y).dot(log(<span class=\"pl-c1\">1<\/span><span class=\"pl-k\">-<\/span>sigmoid(X.dot(theta)))))\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC19\">    \n<\/div><div class=\"line\" id=\"file-log_regression-py-LC20\">    grad <span class=\"pl-k\">=<\/span> transpose((<span class=\"pl-c1\">1.<\/span><span class=\"pl-k\">/<\/span>m)<span class=\"pl-k\">*<\/span>transpose(sigmoid(X.dot(theta)) <span class=\"pl-k\">-<\/span> y).dot(X))\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC21\">    <span class=\"pl-c\">#optimize.fmin expects a single value, so cannot return grad<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC22\">    <span class=\"pl-k\">return<\/span> J[<span class=\"pl-c1\">0<\/span>][<span class=\"pl-c1\">0<\/span>]<span class=\"pl-c\">#,grad<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC23\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC24\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC25\"><span class=\"pl-st\">def<\/span> <span class=\"pl-en\">compute_grad<\/span>(<span class=\"pl-vpf\">theta<\/span>, <span class=\"pl-vpf\">X<\/span>, <span class=\"pl-vpf\">y<\/span>):\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC26\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC27\">    <span class=\"pl-c\">#print theta.shape<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC28\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC29\">    theta.shape <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1<\/span>, <span class=\"pl-c1\">3<\/span>)\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC30\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC31\">    grad <span class=\"pl-k\">=<\/span> zeros(<span class=\"pl-c1\">3<\/span>)\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC32\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC33\">    h <span class=\"pl-k\">=<\/span> sigmoid(X.dot(theta.T))\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC34\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC35\">    delta <span class=\"pl-k\">=<\/span> h <span class=\"pl-k\">-<\/span> y\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC36\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC37\">    l <span class=\"pl-k\">=<\/span> grad.size\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC38\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC39\">    <span class=\"pl-k\">for<\/span> i <span class=\"pl-k\">in<\/span> <span class=\"pl-s3\">range<\/span>(l):\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC40\">        sumdelta <span class=\"pl-k\">=<\/span> delta.T.dot(X[:, i])\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC41\">        grad[i] <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">1.0<\/span> <span class=\"pl-k\">/<\/span> m) <span class=\"pl-k\">*<\/span> sumdelta <span class=\"pl-k\">*<\/span> <span class=\"pl-k\">-<\/span> <span class=\"pl-c1\">1<\/span>\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC42\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC43\">    theta.shape <span class=\"pl-k\">=<\/span> (<span class=\"pl-c1\">3<\/span>,)\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC44\">&nbsp;\n<\/div><div class=\"line\" id=\"file-log_regression-py-LC45\">    <span class=\"pl-k\">return<\/span>  grad\n<\/div><\/pre>\n          <\/td>\n        <\/tr>\n      <\/table>\n    <\/div>\n\n          <\/div>\n          <div class=\"gist-meta\">\n            <a href=\"https://gist.github.com/marcelcaraciolo/1365841/raw/log_regression.py\" style=\"float:right\">view raw<\/a>\n            <a href=\"https://gist.github.com/marcelcaraciolo/1365841#file-log_regression-py\">log_regression.py<\/a>\n            hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n          <\/div>\n        <\/div>\n<\/div>\n')
